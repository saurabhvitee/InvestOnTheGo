# Rebalancing

We will be having a configurable trade window, which will save us trade money by reducing the number of trades. All the scripts will run after every trade window, in the order depicted in the diagram. Scripts are scheduled using cron.

![Project Rebalancing](https://github.com/AkilaTS/CashByChance/blob/main/frontend/src/images/rebalancing.jpeg)

## Update_etf.py
Updates the current prices and information of all the fund.


## Update_worth.py
Updates the investment_summary that involves returns and profit of the user with the updated fundâ€™s prices


## Matchmaking[High level Working]
We employ a bucketing algorithm to determine the funds the user should invest based on their replies to the questionnaire. The User score.py script groups people depending on their responses and the available money. The fund.py script will group money according to five criteria that fit the questions put forth in the questionnaire. A new script named matchmaking.py will match the users to the funds appropriate for their profiles based on the buckets generated by both programs.
 

## Matchmaking [low-level working]
There are five parameters we used for scoring funds and users.
The parameters include-:
```
1. Risk
2. Sector
3. Cap
4. Ticket size
5. Long-term / Short-term investment
 ```
 
## The bucketing algorithm
Using replies from the questionnaire, the User score.py script scores users based on the five factors described above using a straightforward average technique. After then, they are kept in our database.
The parameter given above is also utilized by the Funds.py program to score the funds. Sector, Ticket-size, and Cap are directly mapped to the etf data while the risk is examined using a risk analysis model to determine if the fund is suited for long- or short-term investing. To score each parameter out of 10, we employed a normalization method. These results are then kept in our database.

## Risk Analysis
The five parameters we utilized to analyse the risk associated with a fund are as follows:

```
1. Leverage - Risk is directly correlated with leverage.
2. Moving Average - Risk is directly proportionate to the difference between the 60-day MA and the 20-day MA.
3. Volatility - Risk is directly related to volatility.
4. Beta - Risk is directly proportional to beta.
5. Standard Deviation - Risk is directly proportional to standard deviation
```

We dumped the data from pyetf.db into our database and utilized the parameters from the data in the fund.py script to do the risk analysis. To make their analysis easier, the values of all these parameters were standardized using the linear scaling normalization approach.
We have given the parameters various weights for calculating the overall risk and taken their weighted average.

| Risk Parameters      | Weights |
| ----------- | ----------- |
| Leverage      | 1       |
| 60_day_MA-20_day_MA   | 1        |
| Volatility   | 2        |
| Standard Deviation   | 3        |
| Beta   | 4        |

 
## Matchmaking.py
Use K-nearest neighbour categorization to assign appropriate funds to various users and store them in our database.

Based on the user's deposit wallet transactions over the day, invest.py is triggered if the new transaction results in a credit to the deposit wallet, else redeem.py is activated.

## Invest.py
This script utilizes the matches generated by matchmaking.py to update the user's investment profile in our database with the additional funds bought that day.

## Redeem. Py
When there is a net debit transaction, the redeem.py script takes money from each fund in an equal amount and completes the withdrawal transaction requested by the user at the end of the day. If the amount invested in funds is insufficient,  it changes the status of the transaction failed.
